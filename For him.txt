import { useState, useEffect } from "react";

export default function LoveWebsite() {
  const [page, setPage] = useState("proposal");
  const [score, setScore] = useState(0);
  const [particles, setParticles] = useState([]);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [feedback, setFeedback] = useState("");
  const [answered, setAnswered] = useState(false);

  const questions = [
    {
      question: "ðŸ–¤ What's my favorite color?",
      answers: [
        { text: "Black", correct: true },
        { text: "Blue", correct: false }
      ]
    },
    {
      question: "ðŸŒ™ When do I love going for walks?",
      answers: [
        { text: "At Night", correct: true },
        { text: "Afternoon", correct: false }
      ]
    },
    {
      question: "â„ï¸ What season do I love the most?",
      answers: [
        { text: "Winter", correct: true },
        { text: "Spring", correct: false }
      ]
    },
    {
      question: "â¤ï¸ Who do I love the most?",
      answers: [
        { text: "You", correct: true },
        { text: "Pizza", correct: false }
      ]
    }
  ];

  // âœ¨ Floating Hearts
  useEffect(() => {
    const interval = setInterval(() => {
      const id = Date.now() + Math.random();
      const left = Math.random() * 100;
      const size = 10 + Math.random() * 20;
      setParticles((prev) => [...prev, { id, left, size }]);

      setTimeout(() => {
        setParticles((prev) =>
          prev.filter((p) => p.id !== id)
        );
      }, 7000);
    }, 700);

    return () => clearInterval(interval);
  }, []);

  const startExperience = () => {
    setPage("quiz");
  };

  const handleAnswer = (correct) => {
    if (answered) return;
    setAnswered(true);

    if (correct) {
      setScore((prev) => prev + 1);
      setFeedback("Correct ðŸ˜Œâœ¨ You really know me...");
    } else {
      setFeedback("Wrong ðŸ˜ But I still adore you...");
    }

    setTimeout(() => {
      setFeedback("");
      setAnswered(false);

      if (currentQuestion + 1 < questions.length) {
        setCurrentQuestion((prev) => prev + 1);
      } else {
        setPage("ending");
      }
    }, 1800);
  };

  return (
    <div style={styles.container}>
      <style>{`
        @keyframes float {
          to {
            transform: translateY(110vh) scale(1.5);
            opacity: 0;
          }
        }

        @keyframes fadeCinematic {
          from { opacity: 0; transform: scale(0.95) translateY(20px); }
          to { opacity: 1; transform: scale(1) translateY(0); }
        }

        @keyframes glow {
          0% { text-shadow: 0 0 10px #ff4da6; }
          50% { text-shadow: 0 0 25px #ff99cc; }
          100% { text-shadow: 0 0 10px #ff4da6; }
        }

        body {
          margin: 0;
          padding: 0;
          font-family: 'Poppins', sans-serif;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap');
      `}</style>

      {/* âœ¨ Floating Hearts */}
      {particles.map((p) => (
        <div
          key={p.id}
          style={{
            position: "absolute",
            top: "-30px",
            left: p.left + "vw",
            fontSize: p.size,
            animation: "float 7s linear forwards",
            pointerEvents: "none",
            opacity: 0.6
          }}
          aria-hidden="true"
        >
          ðŸ’–
        </div>
      ))}

      {/* ðŸ’Œ START */}
      {page === "proposal" && (
        <div style={styles.card}>
          <h1 style={styles.glowTitle}>Hey Handsome ðŸ’–</h1>
          <p style={styles.text}>
            Tonight isn't just a gameâ€¦ it's a little reminder of how much you mean to me.
          </p>
          <button 
            style={styles.button} 
            onClick={startExperience}
            aria-label="Begin the love story quiz"
          >
            Begin Our Love Story ðŸŽ¬
          </button>
        </div>
      )}

      {/* ðŸ’˜ QUIZ */}
      {page === "quiz" && (
        <div style={styles.card}>
          <h2 style={styles.title}>Chapter {currentQuestion + 1}</h2>

          <p style={styles.question}>
            {questions[currentQuestion].question}
          </p>

          {questions[currentQuestion].answers.map((answer, index) => (
            <button
              key={index}
              style={{
                ...styles.button,
                opacity: answered ? 0.6 : 1,
                cursor: answered ? "not-allowed" : "pointer"
              }}
              onClick={() => handleAnswer(answer.correct)}
              disabled={answered}
              aria-label={`Answer: ${answer.text}`}
            >
              {answer.text}
            </button>
          ))}

          {feedback && <p style={styles.feedback}>{feedback}</p>}
        </div>
      )}

      {/* ðŸ’• ENDING */}
      {page === "ending" && (
        <div style={styles.card}>
          <h1 style={styles.glowTitle}>Final Score: {score}/4 ðŸ’•</h1>

          <p style={styles.loveLetter}>
            I hope you know that this little game could never measure what you
            truly are to me. You are my safe place, my calm in the chaos, the
            warmth in my coldest days. The way you care, the way you listen, the
            way you simply exist in my life makes everything feel lighter,
            brighter, and more meaningful. You matter to me in ways words can't
            fully explain. You are not just someone I love â€” you are someone I
            admire, respect, and feel endlessly grateful for. No matter what the
            score says, I choose you. Every day. In every lifetime. ðŸ’–
          </p>

          {/* ðŸ˜½ Kissing Cats */}
          <div style={styles.gifRow}>
            <img
              src="https://media.giphy.com/media/3oriO0OEd9QIDdllqo/giphy.gif"
              alt="Two cats kissing each other"
              style={styles.kissGif}
              loading="lazy"
            />
            <img
              src="https://media.giphy.com/media/26BRv0ThflsHCqDrG/giphy.gif"
              alt="Cute animated cats showing love"
              style={styles.kissGif}
              loading="lazy"
            />
          </div>
        </div>
      )}
    </div>
  );
}

const styles = {
  container: {
    minHeight: "100vh",
    background: "radial-gradient(circle at top, #1a001f, #000)",
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    textAlign: "center",
    color: "white",
    fontFamily: "'Poppins', sans-serif",
    overflow: "hidden",
    position: "relative",
    padding: "20px"
  },
  card: {
    background: "rgba(255, 255, 255, 0.08)",
    backdropFilter: "blur(15px)",
    padding: "50px",
    borderRadius: "25px",
    maxWidth: "650px",
    width: "100%",
    animation: "fadeCinematic 0.8s ease",
    boxShadow: "0 30px 60px rgba(255, 0, 120, 0.3)"
  },
  glowTitle: {
    fontSize: "36px",
    fontWeight: "800",
    animation: "glow 3s infinite",
    margin: "0 0 20px 0"
  },
  title: {
    fontSize: "24px",
    marginBottom: "20px",
    margin: "0 0 20px 0"
  },
  text: {
    fontSize: "18px",
    marginBottom: "20px",
    opacity: 0.9
  },
  question: {
    fontSize: "20px",
    marginBottom: "20px",
    fontWeight: "600"
  },
  button: {
    display: "block",
    width: "100%",
    padding: "14px",
    margin: "10px 0",
    borderRadius: "30px",
    border: "none",
    fontSize: "16px",
    fontWeight: "600",
    cursor: "pointer",
    background: "linear-gradient(45deg, #ff1a75, #ff66b2)",
    color: "white",
    transition: "transform 0.2s, box-shadow 0.2s"
  },
  feedback: {
    marginTop: "15px",
    fontSize: "18px",
    fontWeight: "600"
  },
  loveLetter: {
    marginTop: "20px",
    fontSize: "18px",
    lineHeight: "1.8",
    opacity: 0.95
  },
  gifRow: {
    display: "flex",
    justifyContent: "center",
    gap: "20px",
    marginTop: "30px",
    flexWrap: "wrap"
  },
  kissGif: {
    width: "200px",
    borderRadius: "20px",
    boxShadow: "0 10px 30px rgba(255,105,180,0.5)"
  }
};
